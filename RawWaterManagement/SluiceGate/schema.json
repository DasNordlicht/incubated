{
    "$schema": "http://json-schema.org/schema#",
    "$id": "# { todo } #",
    "title": "Open Channel Management - SluiceGate ",
    "description": "This entity contains a harmonised description of a generic Sluice Gate made for Open Channel Management (raw-water systems).",
    "type": "object",
    "allOf": [
      {
        "properties": {
          "type": {
              "type": "string",
              "enum": ["SluiceGate"],
              "description": "NGSI-LD Entity Type"
          },
          "tag": {
            "$ref": "../RawWaterManagement-schema.json#/definitions/tag"
          },
          "gateType": {
            "type": "string",
            "description": "Property. Enum:'SLUICE-GATE'. The type of the gate.",
            "enum": ["Sluice Gate"]
          },
          "gateWidth": {
            "type": "number",
            "minimum": "0",
            "description": "The width of the sluice gate. Units: 'meters'"
          },
          "gateOpening": {
            "type": "number",
            "minimum": "0",
            "description": "Property. The height of gate opening. Units: ['meters', 'percentage']",
            "Unit": {
              "type": "string",
              "enum": ["m", "%"]
            }
          },
          "gateBottomElevation": {
            "type": "number",
            "minimum": "0",
            "description": "Property. Elevation of the bottom (crest) of the gate"
          },
          "gateDischargeCoefficient": {
            "type": "number",
            "minimum": "0",
            "description": "Gate discharge coefficient (m0.5/s) that accounts for energy losses as water passes under the gate"
          },
          "orificeDischargeCoefficient": {
            "type": "number",
            "minimum": "0",
            "description": "Orifice discharge coefficient (m0.5/s) that accounts for energy losses as water passes under the gate and the downstream tailwater increases to the point at which the gate is no longer flowing freely (downstream submergence is causing a greater upstream headwater for a given flow)"
          },
          "waterDischarge": {
            "type": "number",
            "minimum": "0",
            "description": "Property. The discharge that passes the weir (Q)"
          },
          "headDifference": {
            "type": "number",
            "minimum": "0",
            "description": "Property. The difference between the upstream depth and the depth just downstream"
          },
          "flowType": {
            "type": "string",
            "enum": ["Overflow", "Free-Flow", "Submerged Flow"],
            "description": "It defines the flow conditions in the gate. It takes the values: 'Overflow' (upstream water level exceeds the weir crest level), 'Free-Flow' (water level is lower than gate edge), 'Submerged Flow' (the rate of flow passing through the gate is regulated by the opening of the gate)"
          }
        },
        "upstreamEndControlPoint": {
          "type": "object",
          "description": "Description of cross section just upstream of the sluice weir which controls the flow",
          "allOf":[
            {
              "depth":{
                "type": "number",
                "description": "A sub-property: the water depth just upstream of the sluice gate"
              }
            },
            {
              "hasCrossSection":{
                "description": "A sub-relationship indicating the ID of the cross section",
                "$ref": "../CrossSection/schema.json"
              }
            }
          ]
        },
        "justDownsreamControlPoint": {
          "description": "Description of cross section just downstream of the sluice weir which controls the flow",
          "allOf":[
            {
              "depth":{
                "type": "number",
                "description": "A sub-property: the water depth just upstream of the sluice gate"
              }
            },
            {
              "hasCrossSection":{
                "description": "A sub-relationship indicating the ID of the cross section",
                "type": "object",
                "properties":{
                  "$ref": "../RawWaterManagement-schema.json#/ngsildRelationship/properties"
                }
              }
            }
          ]
        },
        "downsreamControlPoint": {
          "description": "Description of cross section downstream of the sluice weir where the flow conditions become permanent",
          "allOf":[
            {
              "depth":{
                "type": "number",
                "description": "A sub-property: the water depth just upstream of the sluice gate"
              }
            },
            {
              "hasCrossSection":{
                "description": "A sub-relationship indicating the ID of the cross section",
                "type": "object",
                "properties":{
                  "$ref": "../RawWaterManagement-schema.json#/ngsildRelationship/properties"
                }
              }
            }
          ]
        },
        "observedBy":{
          "type": "String",
          "description": "Relationship. Model:'https://smart-data-models.github.io/dataModel.Device/device-schema.json'",
          "format": "uri"
        },
        "hasCrossSection":{
          "description": "A sub-relationship indicating the ID of the cross section",
          "type": "object",
          "properties":{
            "$ref": "../RawWaterManagement-schema.json#/ngsildRelationship/properties"
          }
        },
        "curveDischargeCoefficient":{
          "description": "Relationship. Model:'https://smart-data-models.github.io/dataModel.WaterNetworkManagement/Curve/schema.json'. The ID label of the curve that represents the discharge Coefficient as a function of relative weir opening (weir opening over upstream depth), Cd over a/H1",
          "type": "String",
          "format": "uri"
        },
        "attachedTo":{
          "description": "A relationship to the ID of the channel or the junction where the cross-section is attached to. Reference to an entity of type Channel",
          "type": "Relationship",
          "$ref": "../Channel/schema.json"
        }
      }
    ],
    "required": [
        "id",
        "location"
    ]
}
