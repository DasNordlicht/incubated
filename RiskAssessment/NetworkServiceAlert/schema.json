{
    "$schema": "http://json-schema.org/schema#",
    "schemaVersion": "0.0.1",
    "$id": "https://raw.githubusercontent.com/smart-data-models/dataModel.RiskAssessment/master/CyberAnalysis/schema.json",
    "title": "Risk Assessment - CyberAnalysis Entity",
    "description": "",
    "type":"object",
    "allOf":[
        {
            "$ref":"https://smart-data-models.github.io/data-models/common-schema.json#/definitions/GSMA-Commons"
        },
        {
            "$ref": "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/Location-Commons"
        },
        {
            "properties":{
                "type": {
                    "type": "string",
                    "description": "Property. NGSI-LD Entity Type. It must be equal to Risk.",
                    "enum": [
                      "CyberAnalysis"
                    ]
                  },
                "validTo":{
                    "type": "string",
                    "format":"date-time",
                    "description": "Property. Model:'https://schema.org/Time'. The time at which the risk materialziation is started."
                },
                "validFrom":{
                    "type":"string",
                    "format":"date-time",
                    "description": "Property. Model:'https://schema.org/Time'. The time at which the risk materialziation is finished."
                },
                "severity":{
                    "type":"string",
                    "enum": [
                        "LOW",
                        "MEDIUM",
                        "HIGH"
                      ],
                    "description":"Property. The impact generated by the associated Risk"
                },
                "subcategory":{
                    "type":"string",
                    "description": "Property. The MITRE subcategory of an Alert."
                },
                "category":{
                    "type":"string",
                    "description": "Property. The MITRE category of an Alert."
                },
                "name":{
                    "type":"string",
                    "description": "Property. The MITRE name of an Alert."
                },
                "idCode":{
                    "type":"string",
                    "description": "Property. The MITRE code/id of an Alert."
                },
                "identify":{
                    "type":"array",
                    "description":"Relationship. Array of URIs related to the Mitigation Measures.",
                    "items":{
                        "anyOf": [
                            {
                              "type": "string",
                              "minLength": 1,
                              "maxLength": 256,
                              "pattern": "^[\\w\\-\\.\\{\\}\\$\\+\\*\\[\\]`|~^@!,:\\\\]+$",
                              "description": "Property. Identifier format of any NGSI entity"
                            },
                            {
                              "type": "string",
                              "format": "uri",
                              "description": "Property. Identifier format of any NGSI entity"
                            }
                          ]
                    }
                }
            }
        }
    ]
}