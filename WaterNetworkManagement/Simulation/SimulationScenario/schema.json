{
    "$schema": "http://json-schema.org/schema#",
    "$id": "https://smart-data-models.github.io/data-models/specs/WaterNetwork/Simulation/schema.json",
    "title": "WaterNetwork - SimulationScenario",
    "description": "This entity contains a harmonised description of a generic simulation scenario made for the Water Network Management domain. This entity is primarily associated with the water network management vertical and related IoT applications.",
    "type": "object",
    "allOf": [
        {
            "$ref": "https://smart-data-models.github.io/data-models/common-schema.json#/definitions/Location-Commons"
        },
        {
            "$ref": "https://raw.githubusercontent.com/smart-data-models/dataModel.WaterNetworkManagement/master/WaterNetworkManagement-schema.json"
        },
        {
            "properties": {
                "type": {
                    "type": "string",
                    "enum": [
                        "SimulationScenario"
                    ],
                    "description": "NGSI-LD Entity Type"
                },
                "description": {
                    "$ref": "https://raw.githubusercontent.com/smart-data-models/dataModel.WaterNetworkManagement/master/WaterNetworkManagement-schema.json#/definitions/description"
                },
                "createdBy": {
                    "type": "string",
                    "format": "uri",
                    "description": "Relationship. The ID of who created/triggered the simulation"
                },
                "hasInputNetwork": {
                    "type": "string",
                    "format": "uri",
                    "description": "Relationship. The ID of the network used in the simulation"
                },
                "hasSimulationResult": {
                    "type": "string",
                    "format": "uri",
                    "description": "Relationship. The ID of the network used in the simulation"
                },
                "qualityTimeStep": {
                    "type":"number",
                    "description": "Property. The timestep used to track changes in water quality in the network. Given in seconds."
                },
                "duration": {
                    "type":"number",
                    "description": "Property. Duration of the simulation, given in seconds."
                },
                "hydraulicTimeStep": {
                    "type":"number",
                    "description": "Property. Determines how often the hydraulic state of the network is calculated. Given in seconds."
                },
                "reportStep": {
                    "type":"string",
                    "description": "Property. Interval at which output results are reported. given in seconds."
                },
                "reportStart": {
                    "type":"number",
                    "description": "Property. Simulation time at which results start to be reported. Given in seconds from start of simulation."
                },
                "ruleTimeStep": {
                    "type":"number",
                    "description": "Time step used to check for changes in system status due to rule-based controls. Given in seconds."
                },
                "statistic": {
                    "type":"string",
                    "description": "Property. The type of statistical post-processing that is done on the time series of simulation results generated. Options are 'AVERAGED' (report time-averaged results), 'MINIMUM' (report only minimum values), 'MAXIMUM' (report only maximum values), 'RANGE' (report difference between minimum and maximum values) and 'NONE' (report full time series)"
                },
                "trials": {
                    "type":"string",
                    "description": "Property. The the maximum number of trials used to solve network hydraulics at each hydraulic time step of a simulation"
                },
                "accuracy": {
                    "type":"number",
                    "description": "Property. Total normalized flow change convergence criterion for determining when a hydraulic solution has been reached."
                },
                "tolerance": {
                    "type":"number",
                    "description": "Property. Water quality tolerance"
                },
                "emitterExponent": {
                    "type":"number",
                    "description": "Property. Power to which pressure at a junction is raised when computing from from an emitter."
                },
                "headError": {
                    "type":"number",
                    "description": "Property. Maximum headloss convergence criterion for determining when a hydraulic solution has been reached."
                },
                "flowChange": {
                    "type":"number",
                    "description": "Property. Maximum flow change convergence criterion for determining when a hydraulic solution has been reached."
                },
                "demandCharge": {
                    "type":"number",
                    "description": "Property. Energy charge per maximum kW usage."
                },
                "specificGravity": {
                    "type":"number",
                    "description": "Property. The the ratio of the density of the fluid being modeled to that of water at 4 deg. C"
                },
                "viscosity": {
                    "type":"number",
                    "description": "Property. The kinematic viscosity of the fluid being modeled relative to that of water at 20 deg. C"
                },
                "unbalanced": {
                    "type":"string",
                    "description": "Property. Determines what happens if a hydraulic solution cannot be reached within the allowed number of trials. Allowable options are 'STOP' (halt analysis), 'CONTINUE' (continue analysis but with a warning message) and 'CONTINUE_N' (continue for another N trials, where the value of N is given by unbalancedN)"
                },
                "checkFrequency": {
                    "type":"number",
                    "description": "Property. Frequency of hydraulic status checks"
                },
                "maxCheck": {
                    "type":"number",
                    "description": "Property. Number of trials after which status checks are discontinued"
                },
                "dampLimit": {
                    "type": "number",
                    "description": "Property. Accuracy value at which solution damping and status checks begin for PRVs and PSVs."
                },
                "diffusivity": {
                    "type": "number",
                    "description": "Property. Molecular diffusivity of the chemical analysed in a quality analysis, relative to diffusivity of chlorine in water."
                },
                "bulkOrder": {
                    "type": "number",
                    "description": "Property. Bulk water reaction order for pipes"
                },
                "wallOrder": {
                    "type": "number",
                    "description": "Property. Wall reaction order for pipes"
                },
                "tankOrder": {
                    "type":"string",
                    "description": "Property. Bulk water reaction order for tanks"
                },
                "concentrationLimit": {
                    "type":"string",
                    "description": "Property. Limiting concentration for growth reactions"
                },
                "qualityType": {
                    "type":"string",
                    "description": "Property. Type of water quality analysis"
                },
                "chemicalName": {
                    "type":"string",
                    "description": "Property. Name of the chemical modelled. Only used if qualityType is CHEM."
                },
                "chemicalUnits": {
                    "type":"string",
                    "description": "Property. Units of the chemical modelled. Only used if qualityType is CHEM."
                },
                "traceNodeID": {
                    "type": "string",
                    "format": "uri",
                    "description": "Relationship. URI of node being traced in the quality analysis. Mandatory if qualityType is TRACE, otherwise not required"
                },
                "flowUnits": {
                    "type": "string",
                    "description": "Property. Units in which flow rates are expressed in the simulation. Allowable options are 'CFS' (cubic feet per second), 'GPM' (gallons per minute), 'MGD' (million gallons per day), 'IMGD' (imperial MGD), 'AFD' (acre-feet per day), 'LPS' (litres pre second), 'LPM' (litres per minute), 'MLD' (million litres per day), 'CMH' (cubic metres per hour) and 'CMD' (cubic metres per day)."
                },
                "headlossFormula": {
                    "type":"string",
                    "description": "Property. Formula used for computing head loss for flow through a pipe. The choices are the Hazen-Williams (H-W), Darcy-Weisbach (D-W) or Chezy-Manning (C-M) formulas."
                },
                "demandModel": {
                    "type":"string",
                    "description": "Property. Specifies whether a the analysis is pressure driven ('PDA') or demand driven ('DDA')."
                },
                "operationalControl": {
                    "type":"string",
                    "description": "Property.  Description of a control applied to the network for the simulation"
                },
                "triggerLevel": {
                    "type":"string",
                    "description": "Property. Level at which control is activated. A sub-property of the Property control"
                },
                "setting": {
                    "type":"string",
                    "description": "Property. Setting applied in the to the controlled link when trigger level is reached. A sub-property of the Property control"
                },
                "controlType": {
                    "type":"string",
                    "description": "Property.  Control type. A sub-property of the Property control"
                },
                "controlledLink": {
                    "type": "string",
                    "format": "uri",
                    "description": "Relationship. Link controlled. A sub-relationship of the Property control."
                },
                "monitoredNode": {
                    "type": "string",
                    "format": "uri",
                    "description": "Relationship. Node which is monitored for control trigger level. A sub-relationship of the Property control."
                },
                "targetURI": {
                    "type": "string",
                    "format": "uri",
                    "description": "Relationship.URI of network component with property modified in simulation. A sub-relationship of the Property water attribute."
                },
                "inputParameters": {
                    "type": "string",
                    "description": "Property. Description of the set of modifications to be applied to the network for the simulation"
                }
            }
        }
    ],
    "required": [
        "id",
        "type"
    ]
}
